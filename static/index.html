<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moana Alive - Anima√ß√£o de Fotos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center mb-4">üé¨ Moana Alive</h1>
        
        <ul class="nav nav-tabs" id="mainTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="video-tab" data-bs-toggle="tab" data-bs-target="#video" type="button">
                    üì∏ Animar Foto
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="audio-tab" data-bs-toggle="tab" data-bs-target="#audio" type="button">
                    üé§ Gerar √Åudio
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="lipsync-tab" data-bs-toggle="tab" data-bs-target="#lipsync" type="button">
                    üíã Lip Sync
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="synced-tab" data-bs-toggle="tab" data-bs-target="#synced" type="button">
                    üé¨ Sincronizados
                </button>
            </li>
        </ul>

        <div class="tab-content mt-4" id="mainTabContent">
            <!-- Aba Animar Foto -->
            <div class="tab-pane fade show active" id="video">
                <div class="card">
                    <div class="card-body">
                        <form id="videoForm" enctype="multipart/form-data">
                            <div class="mb-3">
                                <label class="form-label">Escolha uma foto:</label>
                                <div class="d-flex gap-2 mb-2 flex-wrap">
                                    <button type="button" class="btn btn-outline-primary btn-sm" id="cameraBtn">
                                        üì∑ C√¢mera Web
                                    </button>
                                    <button type="button" class="btn btn-outline-success btn-sm" id="mobileCameraBtn">
                                        üì± C√¢mera Celular
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary btn-sm" id="fileBtn">
                                        üìÅ Escolher Arquivo
                                    </button>
                                </div>
                                
                                <!-- Aviso sobre HTTPS -->
                                <div id="httpsWarning" class="alert alert-warning alert-sm" style="display: none;">
                                    <small>
                                        ‚ö†Ô∏è <strong>C√¢mera indispon√≠vel:</strong> Para usar a c√¢mera, acesse via HTTPS ou localhost. 
                                        <br>
                                        üí° <strong>Como resolver:</strong> Execute <code>python run.py</code> e acesse <code>http://localhost:8000</code>
                                    </small>
                                </div>
                                
                                <!-- Camera capture area -->
                                <div id="cameraArea" class="camera-area" style="display: none;">
                                    <video id="cameraVideo" class="camera-video" autoplay></video>
                                    <canvas id="cameraCanvas" style="display: none;"></canvas>
                                    <div class="camera-controls mt-2">
                                        <button type="button" class="btn btn-success btn-sm" id="captureBtn">
                                            üì∏ Capturar Foto
                                        </button>
                                        <button type="button" class="btn btn-secondary btn-sm" id="stopCameraBtn">
                                            ‚ùå Fechar C√¢mera
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- File input -->
                                <input type="file" class="form-control" name="file" id="fileInput" accept="image/*" style="display: none;">
                                
                                <!-- Mobile camera input -->
                                <input type="file" class="form-control" id="mobileCameraInput" accept="image/*" capture="environment" style="display: none;">
                                
                                <!-- Preview area -->
                                <div id="imagePreview" class="image-preview mt-2" style="display: none;">
                                    <img id="previewImg" class="preview-image">
                                    <button type="button" class="btn btn-sm btn-outline-danger mt-1" id="removeImageBtn">
                                        üóëÔ∏è Remover
                                    </button>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Prompt para anima√ß√£o:</label>
                                <input type="text" class="form-control" name="prompt" 
                                       placeholder="Ex: A person waving hands to the camera" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Dura√ß√£o do v√≠deo:</label>
                                <select class="form-control" name="duration" required>
                                    <option value="6">6 segundos</option>
                                    <option value="10">10 segundos</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-primary">üé¨ Gerar V√≠deo</button>
                        </form>
                        <div id="videoResult" class="mt-3"></div>
                        
                        <hr class="my-6">
                        
                        <h5>üìΩÔ∏è V√≠deos Gerados</h5>
                        <div id="videoGallery" class="row">
                            <div class="col-12 text-center text-muted">
                                Carregando galeria...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Gerar √Åudio -->
            <div class="tab-pane fade" id="audio">
                <div class="card">
                    <div class="card-body">
                        <h5>Gerar √Åudio com IA</h5>
                        <form id="audioForm">
                            <div class="mb-3">
                                <label class="form-label">Texto para falar:</label>
                                <textarea class="form-control" name="text" rows="3" 
                                          placeholder="Digite o texto que deseja transformar em voz" required></textarea>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Voz:</label>
                                <select class="form-control" name="voice_id">
                                    <option value="Lively_Girl">Menina Animada</option>
                                    <option value="Lovely_Girl">Menina Carinhosa</option>
                                    <option value="Sweet_Girl_2">Menina Doce</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-success">üé§ Gerar √Åudio</button>
                        </form>
                        <div id="audioResult" class="mt-3"></div>
                        
                        <hr class="my-4">
                        
                        <h5>üéµ √Åudios Gerados</h5>
                        <div id="audioGallery" class="row">
                            <div class="col-12 text-center text-muted">
                                Carregando √°udios...
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Aba Lip Sync -->
            <div class="tab-pane fade" id="lipsync">
                <div class="card">
                    <div class="card-body">
                        <h5>Sincronizar Labial</h5>
                        <form id="lipsyncForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>üìπ Selecione um V√≠deo:</h6>
                                    <div id="videoSelector" class="video-selector mb-3">
                                        <div class="text-center text-muted">Carregando v√≠deos...</div>
                                    </div>
                                    <input type="hidden" name="video_path" id="selectedVideoPath" required>
                                </div>
                                <div class="col-md-6">
                                    <h6>üé§ Selecione um √Åudio:</h6>
                                    <div id="audioSelector" class="audio-selector mb-3">
                                        <div class="text-center text-muted">Carregando √°udios...</div>
                                    </div>
                                    <input type="hidden" name="audio_path" id="selectedAudioPath" required>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-warning">üíã Sincronizar</button>
                        </form>
                        <div id="lipsyncResult" class="mt-3"></div>
                    </div>
                </div>
            </div>

            <!-- Aba V√≠deos Sincronizados -->
            <div class="tab-pane fade" id="synced">
                <div class="card">
                    <div class="card-body">
                        <h5>üé¨ V√≠deos Sincronizados</h5>
                        <p class="text-muted">Todos os v√≠deos com lip sync j√° processados</p>
                        
                        <div id="syncedGallery" class="row">
                            <div class="col-12 text-center text-muted">
                                Carregando v√≠deos sincronizados...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/script.js"></script>
</body>
</html>
